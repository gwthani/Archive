(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17],{1678:(e,r,t)=>{"use strict";t.d(r,{default:()=>R});var a=t(66384),n=t(55850),s=t(27131),l=t(77371),i=t(8481),o=t(74680),d=t(89549),c=t(725),u=t(66525),h=t(47507),m=t(65055),f=t(42402),x=t.n(f),p=t(31238),j=t(61552),g=t(15811),b=t(9440),y=t(7048),v=t(24582),A=t(53947),w=t(16636),S=t(55836);let D=(0,S.createServerReference)("40607f026c0b965d0c2bd629ebe765ea39899efdda",S.callServer,void 0,S.findSourceMapURL,"default");var k=t(46085);let C={q:k.tU,value:k.tU,orderBy:k.tU,orderDir:k.tU,page:k.GJ,pageSize:k.GJ};(0,k.Eq)(C);let Y=(0,S.createServerReference)("40c89ec07aab1564a3643822b8f5d5a027f38c501b",S.callServer,void 0,S.findSourceMapURL,"default");var _=t(43101);let I=e=>{var r,t,n;let{book:l,callback:i}=e,{notification:o,message:d}=s.A.useApp(),[c,u]=(0,w.useState)(!1),h=async(e,r)=>{let{...t}=e;try{let e=await Y({...t,id:l.id});r.resetFields(),i(e),d.success("Updated!")}catch(e){var a;o.error({message:null==(a=e.toString)?void 0:a.call(e),showProgress:!0,pauseOnHover:!0,placement:"bottomLeft"}),console.error("failed to update project: ",e)}};return(0,a.jsx)(_.A,{onSubmit:h,isLoading:!1,onFieldsChange:()=>u(!0),onReset:()=>u(!1),disableButtons:!c,submitText:"تحديث",initialValues:{...l,releaseDate:x()(l.releaseDate,"YYYY"),printDate:x()(l.printDate),authorId:{value:l.authorId,label:"".concat(null==(r=l.Author)?void 0:r.firstName," ").concat(null==(t=l.Author)?void 0:t.middleName," ").concat(null==(n=l.Author)?void 0:n.lastName)}}})},{Text:z}=n.A,N={orderBy:"id",orderDir:"desc"},q=e=>{let{index:r,confirm:t,setSearchFilter:n,refresh:s}=e;return(0,a.jsx)("div",{style:{padding:8},onKeyDown:e=>e.stopPropagation(),children:(0,a.jsx)(m.A,{placeholder:"بحث",onSearch:async e=>{var a;t(),await n({q:r,value:null!=(a=e.trim())?a:null,page:1}),s()},enterButton:!0,width:200})})},R=e=>{let{data:r,count:t,isAdmin:n,...m}=e,{modal:f,notification:S}=s.A.useApp(),k=(0,v.useRouter)(),[Y,_]=(0,A.ab)(C),[R,L]=(0,w.useTransition)(),U=()=>{L(()=>{k.refresh()})},F=async()=>{await _(null),U()},P=(0,w.useMemo)(()=>[{key:"code",title:"الكود",dataIndex:"code",width:170,render:e=>(0,a.jsx)(z,{copyable:!0,children:e}),filterIcon:(0,a.jsx)(p.A,{size:14}),filterDropdown:e=>{let{confirm:r}=e;return(0,a.jsx)(q,{index:"code",confirm:r,setSearchFilter:_,refresh:U})}},{key:"name",title:"اسم الكتاب",fixed:"left",dataIndex:"name",filterIcon:(0,a.jsx)(p.A,{size:14}),filterDropdown:e=>{let{confirm:r}=e;return(0,a.jsx)(q,{index:"name",confirm:r,setSearchFilter:_,refresh:U})}},{key:"author",title:"الكاتب",dataIndex:"Author",minWidth:350,render:(e,r)=>{let{Author:t}=r;return(0,a.jsx)(l.A,{content:(0,a.jsxs)("div",{children:[(0,a.jsx)(i.A,{shape:"square",style:{margin:"auto",width:100,height:100},src:null==t?void 0:t.photoUrl,children:(0,a.jsx)(j.A,{})}),(0,a.jsx)("div",{style:{fontWeight:"bold"},children:"".concat(null==t?void 0:t.firstName," ").concat((null==t?void 0:t.middleName)||""," ").concat(null==t?void 0:t.lastName)}),(0,a.jsx)("span",{children:x()(null==t?void 0:t.birthDate).format("YYYY")}),(0,a.jsx)("span",{children:(null==t?void 0:t.deathDate)&&" - ".concat(x()(null==t?void 0:t.deathDate).format("YYYY"))}),(0,a.jsx)("div",{children:null==t?void 0:t.overview})]}),children:(0,a.jsxs)("div",{style:{cursor:"pointer"},children:[null==t?void 0:t.firstName," ",(null==t?void 0:t.middleName)||""," ",null==t?void 0:t.lastName]})})},filterIcon:(0,a.jsx)(p.A,{size:14}),filterDropdown:e=>{let{confirm:r}=e;return(0,a.jsx)(q,{index:"Author",confirm:r,setSearchFilter:_,refresh:U})}},{key:"translator",title:"المترجم",dataIndex:"translator",filterIcon:(0,a.jsx)(p.A,{size:14}),filterDropdown:e=>{let{confirm:r}=e;return(0,a.jsx)(q,{index:"translator",confirm:r,setSearchFilter:_,refresh:U})}},{key:"checker",title:"المحقق",dataIndex:"checker",filterIcon:(0,a.jsx)(p.A,{size:14}),filterDropdown:e=>{let{confirm:r}=e;return(0,a.jsx)(q,{index:"checker",confirm:r,setSearchFilter:_,refresh:U})}},{key:"pagesCount",title:"عدد الصفحات",dataIndex:"pagesCount",width:150,sorter:!0,sortDirections:["ascend","descend","ascend"]},{key:"releaseDate",title:"تاريخ الإصدار",dataIndex:"releaseDate",width:150,sorter:!0,sortDirections:["ascend","descend","ascend"],render:(e,r)=>x()(r.releaseDate).format("YYYY")},{key:"weight",title:"الوزن",dataIndex:"weight",width:150},{key:"deminsions",title:"الأبعاد",dataIndex:"deminsions",width:180,render:(e,r)=>"".concat(r.length," \xd7 ").concat(r.width," \xd7 ").concat(r.height)},{key:"printDate",title:"تاريخ الطباعة",dataIndex:"printDate",width:150,sorter:!0,sortDirections:["ascend","descend","ascend"],render:(e,r)=>x()(r.printDate).format("DD/MM/YYYY")},{key:"actions",align:"center",width:100,hidden:!n,render:(e,r)=>{let t=async()=>{f.warning({closable:!0,maskClosable:!0,title:"Delete project",content:"Are you sure to delete project ".concat(r.code,"?"),onOk:async()=>{try{D({id:r.id})}catch(r){var e;S.error({message:null==(e=r.toString)?void 0:e.call(r),showProgress:!0,pauseOnHover:!0,placement:"bottomLeft"})}},okButtonProps:{danger:!0}})};return(0,a.jsxs)(o.A,{size:"middle",children:[(0,a.jsx)(b.A,{size:14,color:"#096dd9",onClick:()=>{let{destroy:e}=f.info({width:800,destroyOnClose:!0,closable:!0,maskClosable:!0,icon:(0,a.jsx)(g.A,{color:"#096dd9",style:{marginLeft:10}}),title:"".concat(r.name),content:(0,a.jsx)(I,{book:r,callback:()=>e()}),footer:null,style:{marginTop:-70}})},style:{cursor:"pointer"}}),(0,a.jsx)(y.A,{size:14,color:"red",onClick:t,style:{cursor:"pointer"}})]})}}].filter(e=>!e.hidden),[f,_,n,S]),O=async(e,r,t)=>{Array.isArray(t)||(t.order&&t.columnKey?await _({orderBy:String(t.columnKey),orderDir:"ascend"===t.order?"asc":"desc"}):await _(N),U())};return(0,a.jsx)(d.A,{...m,columns:P,loading:!1,dataSource:r,onChange:O,rowKey:e=>e.id,scroll:{x:1800},title:()=>(0,a.jsx)(c.A,{justify:"end",children:(0,a.jsxs)(o.A,{size:"middle",children:[R?(0,a.jsx)(u.A,{}):null,(0,a.jsx)(h.Ay,{onClick:()=>U(),children:"تحديث"}),(0,a.jsx)(h.Ay,{danger:!0,disabled:!Y,onClick:F,children:"مسح البحث"})]})}),pagination:{pageSize:Y.pageSize||10,total:t,current:Y.page||1,onChange:(e,r)=>{_({page:e})},showSizeChanger:!0,onShowSizeChange:(e,r)=>{_({pageSize:r})}}})}},4745:e=>{e.exports={container:"Dashboard_container__zuc8l",main:"Dashboard_main__c4QjI",header:"Dashboard_header__lJFol",formContainer:"Dashboard_formContainer__lSX0w",textLink:"Dashboard_textLink__0uNSI",logoutButton:"Dashboard_logoutButton__QpCCX",buttonContainer:"Dashboard_buttonContainer__IjHEU"}},25299:(e,r,t)=>{Promise.resolve().then(t.bind(t,1678)),Promise.resolve().then(t.bind(t,41650)),Promise.resolve().then(t.t.bind(t,4745,23)),Promise.resolve().then(t.bind(t,61270))},41650:(e,r,t)=>{"use strict";t.d(r,{default:()=>o});var a=t(66384),n=t(27131);t(16636);var s=t(55836);let l=(0,s.createServerReference)("406e48bba3904b4f4a62398ca93af20af1374a0e56",s.callServer,void 0,s.findSourceMapURL,"default");var i=t(43101);let o=()=>{let{notification:e,message:r}=n.A.useApp(),t=async(t,a)=>{try{await l(t),a.resetFields(),r.success("Created!")}catch(r){var n;e.error({message:"P2002"===r.code?"book must be unique":null==(n=r.toString)?void 0:n.call(r),showProgress:!0,pauseOnHover:!0,placement:"bottomLeft"}),console.error("failed to create new project: ",r)}};return(0,a.jsx)(i.A,{onSubmit:t,isLoading:!1})}},43101:(e,r,t)=>{"use strict";t.d(r,{A:()=>D});var a=t(66384),n=t(15590),s=t(95957),l=t(34991),i=t(51531),o=t(725),d=t(74680),c=t(47507),u=t(60448),h=t(14569),m=t(42402),f=t.n(m),x=t(16636);let p=(e,r)=>{let t=(0,x.useRef)(e),a=(0,x.useRef)(null);return(0,x.useEffect)(()=>{t.current=e},[e]),function(){for(var e=arguments.length,n=Array(e),s=0;s<e;s++)n[s]=arguments[s];a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{t.current(...n)},r)}};var j=t(95873),g=t(66525),b=t(8481),y=t(61552),v=t(55836);let A=(0,v.createServerReference)("7fff19a7a604f72b2c14efe6d0f784b5580baa2831",v.callServer,void 0,v.findSourceMapURL,"searchAuthors"),w=function(e){let[r,t]=(0,x.useState)(!1),[n,s]=(0,x.useState)([]),l=p(async e=>{if(e.trim()){t(!0);try{let r=(await A(e)).map(e=>({key:e.id,value:e.id,label:"".concat(e.firstName," ").concat(e.middleName," ").concat(e.lastName),...e}));s(r),t(!1)}catch(e){t(!1),console.error("failed to fetch select options")}}},500);return(0,a.jsx)(j.A,{showSearch:!0,filterOption:!1,onSearch:e=>l(e),notFoundContent:r?(0,a.jsx)(g.A,{size:"small"}):"No results found",options:n,optionRender:e=>(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(b.A,{style:{marginLeft:8},size:50,src:e.data.photoUrl,children:(0,a.jsx)(y.A,{})}),e.label]},e.data.id),...e})},S=h.A,D=e=>{let{onSubmit:r,isLoading:t,disableButtons:h,submitText:m,...x}=e,[p]=(0,u.A)();return(0,a.jsxs)(n.A,{form:p,onFinish:e=>{r({...e,releaseDate:e.releaseDate.get("year").toString(),printDate:e.printDate.toISOString()},p)},labelCol:{span:6},wrapperCol:{span:16},style:{width:"100%",maxWidth:1e3},autoComplete:"off",...x,children:[(0,a.jsx)(S,{name:"name",label:"الاسم",rules:[{required:!0,message:""}],children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"authorId",label:"الكاتب",rules:[{required:!0,message:""}],children:(0,a.jsx)(w,{})}),(0,a.jsx)(S,{name:"checker",label:"المحقق",children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"translator",label:"المترجم",children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"width",label:"العرض",rules:[{required:!0,message:""}],children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"length",label:"الطول",rules:[{required:!0,message:""}],children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"height",label:"الارتفاع",rules:[{required:!0,message:""}],children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"weight",label:"الوزن",rules:[{required:!0,message:""}],children:(0,a.jsx)(s.A,{})}),(0,a.jsx)(S,{name:"pagesCount",label:"عدد الصفحات",rules:[{required:!0,message:""}],children:(0,a.jsx)(l.A,{min:1})}),(0,a.jsx)(S,{name:"releaseDate",label:"سنة الاصدار",rules:[{required:!0,message:""}],normalize:e=>"string"==typeof e?f()(e,"YYYY"):e,children:(0,a.jsx)(i.A,{picker:"year",format:"YYYY"})}),(0,a.jsx)(S,{name:"printDate",label:"تاريخ الطباعة",rules:[{required:!0,message:""}],children:(0,a.jsx)(i.A,{})}),(0,a.jsx)(S,{name:"bookUrl",label:"رابط الكتاب",rules:[{required:!0,message:""}],children:(0,a.jsx)(s.A,{style:{direction:"ltr"}})}),(0,a.jsx)(o.A,{justify:"end",style:{paddingRight:"4rem"},children:(0,a.jsxs)(d.A,{children:[(0,a.jsx)(c.Ay,{type:"primary",htmlType:"submit",loading:t,disabled:!!h,children:null!=m?m:"إنشاء"}),(0,a.jsx)(c.Ay,{htmlType:"reset",disabled:!!h,children:"مسح"})]})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[862,822,879,497,269,988,131,270,525,173,240,433,355,147,309,951,358],()=>r(25299)),_N_E=e.O()}]);