(()=>{var e={};e.id=14,e.ids=[14],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3568:()=>{},5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},43817:(e,r,t)=>{"use strict";t.d(r,{db:()=>a});var s=t(96330);global.__prisma||(global.__prisma=new s.PrismaClient),global.__prisma.$connect();let a=global.__prisma},44372:(e,r,t)=>{"use strict";t.d(r,{j2:()=>x,LX:()=>v,Y9:()=>w});var s=t(35039);s.z.enum(["USER","EDITOR","ADMIN"]).default("USER");let a=s.z.string().email().transform(e=>e.toLowerCase().trim()),o=s.z.string().min(8).max(100).transform(e=>e.trim());s.z.object({email:a,password:o});let n=s.z.object({username:s.z.string(),password:s.z.string()});s.z.object({email:a}),s.z.object({password:o,passwordConfirmation:o,token:s.z.string().optional()}).refine(e=>e.password===e.passwordConfirmation,{message:"Passwords don't match",path:["passwordConfirmation"]}),s.z.object({currentPassword:s.z.string(),newPassword:o});var i=t(43817),u=t(85638),p=t(6766),c=t(5486),d=t.n(c);let l=Number.parseInt(process.env.SALT_ROUNDS||"");if(!l||!Number.isInteger(l))throw Error("SALT_ROUNDS environment variable is not set");let m=async(e,r)=>await d().compare(e,r),{auth:x,handlers:w,signIn:g,signOut:h}=(0,u.Ay)({trustHost:"true"===process.env.TRUST_HOST,useSecureCookies:"false"!==process.env.SECURE_COOKIES,callbacks:{authorized:async({auth:e})=>!!e,jwt:({token:e,user:r})=>(r&&(e.user=r),e),session:({session:e,token:r})=>({...e,user:{...e.user,...r.user}})},cookies:{sessionToken:{options:{}}},providers:[(0,p.A)({name:"credentials",async authorize(e,r){try{let{username:r,password:t}=n.parse(e),s=await i.db.user.findFirst({where:{username:r}});if(s&&await m(t,s.passwordHash))return{id:s.id,name:s.username,role:s.role}}catch(e){return null}return console.log("failed to authorize..."),null}})],pages:{signIn:"/auth/login"}}),v=async e=>{let r=await x();return e.findIndex(e=>e===r?.user.role)>=0}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},57631:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>l,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{GET:()=>i,POST:()=>u});var a=t(99268),o=t(24825),n=t(55472);let{GET:i,POST:u}=t(44372).Y9,p=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/Users/jad/Desktop/dev/smart/new-arc/app/api/auth/[...nextauth]/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:d,serverHooks:l}=p;function m(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:d})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},93840:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")},99268:(e,r,t)=>{"use strict";e.exports=t(44870)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[175,509,667],()=>t(57631));module.exports=s})();