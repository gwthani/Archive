(()=>{var e={};e.id=435,e.ids=[435],e.modules={1444:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>d});var s=t(93582),a=t(24825),n=t(31553),o=t.n(n),i=t(4782),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(r,l);let d={children:["",{children:["(protected)",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,20847)),"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,57387)),"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,9440)),"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,83671,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,88986,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,5827,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,15356))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,41010)),"/Users/jad/Desktop/dev/smart/new-arc/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,61900)),"/Users/jad/Desktop/dev/smart/new-arc/app/error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,81306)),"/Users/jad/Desktop/dev/smart/new-arc/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,83671,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,88986,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,5827,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,15356))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,u=["/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/page.tsx"],c={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(protected)/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2469:e=>{e.exports={container:"Dashboard_container__zuc8l",main:"Dashboard_main__c4QjI",header:"Dashboard_header__lJFol",formContainer:"Dashboard_formContainer__lSX0w",textLink:"Dashboard_textLink__0uNSI",logoutButton:"Dashboard_logoutButton__QpCCX",buttonContainer:"Dashboard_buttonContainer__IjHEU"}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3568:()=>{},5486:e=>{"use strict";e.exports=require("bcrypt")},8842:(e,r,t)=>{Promise.resolve().then(t.bind(t,21823)),Promise.resolve().then(t.bind(t,64101)),Promise.resolve().then(t.bind(t,20783)),Promise.resolve().then(t.bind(t,9020))},9440:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});var s=t(92710),a=t(44372),n=t(69950);async function o({children:e}){let r=await (0,a.j2)(),t=r?.user.role||"USER";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.default,{role:t}),e,(0,s.jsx)("footer",{})]})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},18488:(e,r,t)=>{Promise.resolve().then(t.bind(t,69950))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20783:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(678).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/components/UserList.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/components/UserList.tsx","default")},20847:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>v});var s=t(92710),a=t(44372),n=t(21823),o=t(9020),i=t(59921),l=t.n(i),d=t(64101),u=t(20783),c=t(43817),p=t(12917);let m=async({where:e,orderBy:r,skip:t=0,take:s=100})=>{await (0,a.LX)(["ADMIN"])||(0,p.redirect)("/auht/login");let n=await c.db.user.count({where:e});return{users:await c.db.user.findMany({skip:t,take:s,orderBy:r,where:e}),count:n}};var f=t(86485);let h={page:f.YC.withDefault(1)},b=(0,f.Eq)(h);async function v({searchParams:e}){if(!await (0,a.LX)(["ADMIN"]))return(0,s.jsx)(n.Result,{status:"error",title:"Not Authorized"});let{page:r}=await b(e),t=await m({skip:(r-1)*10,take:10});return(0,s.jsxs)("main",{className:l().main,children:[(0,s.jsxs)("div",{className:l().formContainer,children:[(0,s.jsx)(o.default,{level:2,style:{marginLeft:"5rem"},children:"أضف مستخدم"}),(0,s.jsx)(d.default,{})]}),(0,s.jsx)("div",{className:l().listContainer,children:(0,s.jsx)(u.default,{users:t.users,count:t.count})})]})}},21823:(e,r,t)=>{"use strict";t.d(r,{Result:()=>s});let s=(0,t(678).registerClientReference)(function(){throw Error("Attempted to call Result() from the server but Result is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jad/Desktop/dev/smart/new-arc/node_modules/.pnpm/antd@5.25.2_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/antd/es/index.js@__barrel_optimize__?names=Result","Result")},28216:(e,r,t)=>{Promise.resolve().then(t.bind(t,34165))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34165:(e,r,t)=>{"use strict";t.d(r,{default:()=>h});var s=t(59260),a=t(46211),n=t(8608),o=t(64939),i=t(85867),l=t(77199),d=t.n(l),u=t(86482);t(39045);var c=t(42500);let p=(0,c.createServerReference)("7fbccf63901d2a977697f12a1d602c14f4768d5b6f",c.callServer,void 0,c.findSourceMapURL,"logout");var m=t(2469),f=t.n(m);let h=({role:e})=>{let r=(0,u.usePathname)(),t=[{label:(0,s.jsx)(d(),{href:"/books",children:"الكتب"}),key:"/books"},["ADMIN","EDITOR"].find(r=>r===e)?{label:(0,s.jsx)(d(),{href:"/authors",children:"المؤلفين"}),key:"/authors"}:null,"ADMIN"===e?{label:(0,s.jsx)(d(),{href:"/users",children:"المستخدمين"}),key:"/users"}:null,{label:(0,s.jsx)(d(),{href:"/settings",children:"الإعدادات"}),key:"/settings"},{label:"تسجيل الخروج",key:"/logout",icon:(0,s.jsx)(o.A,{size:14}),className:f().logoutButton,onClick:()=>p()}];return(0,s.jsxs)(n.Y9,{className:f().header,dir:"rtl",children:[(0,s.jsx)(i.default,{alt:"Voton_logo",src:"/voton-logo-new.png",priority:!0,height:24,width:91}),(0,s.jsx)(a.A,{theme:"light",mode:"horizontal",items:t,activeKey:r||"/",style:{flex:1,minWidth:0,marginLeft:12}})]})}},47924:(e,r,t)=>{"use strict";t.d(r,{default:()=>v});var s=t(59260),a=t(76469),n=t(43513),o=t(62476),i=t(32811),l=t(76630),d=t(36552),u=t(52671),c=t(86482),p=t(74835);t(39045);var m=t(42500);let f=(0,m.createServerReference)("40e39e9e7f978e8bd5c1375f0f8436b5ed0f064986",m.callServer,void 0,m.findSourceMapURL,"default"),h={USER:"مستخدم",EDITOR:"محرر",ADMIN:"مشرف"},b=({id:e,email:r,disabled:t})=>{let{modal:o,notification:i}=a.A.useApp(),l=async()=>{o.warning({closable:!0,maskClosable:!0,title:"Delete user",content:`Are you sure to delete user with email ${r}?`,onOk:async()=>{try{await f({id:e})}catch(e){i.error({message:e.toString?.(),showProgress:!0,pauseOnHover:!0,placement:"bottomLeft"})}},okButtonProps:{danger:!0}})};return(0,s.jsx)(n.Ay,{type:"link",danger:!0,onClick:l,disabled:t,children:"حذف"})},v=({users:e,count:r})=>{let t=(0,u.wV)(),a=(0,c.useRouter)(),[n,m]=(0,p.ZA)("page",p.GJ);return(0,s.jsx)(o.A,{avatar:!0,loading:!1,active:!0,children:(0,s.jsx)(i.A,{itemLayout:"horizontal",dataSource:e,pagination:{pageSize:10,total:0===e.length?r+1:r,current:n??1,onChange:async(e,r)=>{await m(e),a.refresh()}},rowKey:e=>e.id,renderItem:e=>(0,s.jsx)(i.A.Item,{actions:[(0,s.jsx)(b,{id:e.id,email:e.username,disabled:e.id===t.data?.user?.id},e.id)],children:(0,s.jsx)(i.A.Item.Meta,{avatar:(0,s.jsx)(l.A,{children:(0,s.jsx)(d.A,{})}),title:e.username,description:h[e.role]})})})})}},55511:e=>{"use strict";e.exports=require("crypto")},57387:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(92710);function a({children:e}){return(0,s.jsx)(s.Fragment,{children:e})}},59921:e=>{e.exports={main:"Users_main__1yCsH",formContainer:"Users_formContainer__Rwe5V",listContainer:"Users_listContainer__zKPkp",textLink:"Users_textLink__Nk3uj"}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64101:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(678).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/components/NewUserForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jad/Desktop/dev/smart/new-arc/app/(protected)/users/components/NewUserForm.tsx","default")},65528:(e,r,t)=>{"use strict";t.d(r,{default:()=>x});var s=t(59260),a=t(76469),n=t(23421),o=t(19244),i=t(97045),l=t(10031),d=t(27623),u=t(43513),c=t(21685),p=t(58036),m=t(434),f=t(39045),h=t(42500);let b=(0,h.createServerReference)("4092d61064b5e56b6a097920fe07164603cd949f73",h.callServer,void 0,h.findSourceMapURL,"default"),v=[{value:"USER",label:"مستخدم"},{value:"EDITOR",label:"محرر"},{value:"ADMIN",label:"مشرف"}],x=()=>{let{notification:e,message:r}=a.A.useApp(),[t]=(0,c.A)(),[h,x]=(0,f.useState)(!1),j=async s=>{x(!0);try{await b({email:s.email,password:s.password,role:s.role}),t.resetFields(),x(!1),r.success("Created!")}catch(t){x(!1);let r="Error, failed to create";"P2002"===t.code?r="email must be unique":"ZodError"===t.name?(console.error("json:: ",JSON.parse(t.message)),r=JSON.parse(t.message)?.[0]?.message||"invalid input"):r=t.toString?.(),e.error({message:r,showProgress:!0,pauseOnHover:!0,placement:"bottomLeft"})}};return(0,s.jsxs)(n.A,{form:t,onFinish:j,labelCol:{span:6},wrapperCol:{span:12},style:{width:"100%",maxWidth:500,alignSelf:"center"},autoComplete:"off",requiredMark:!1,children:[(0,s.jsx)(p.A,{name:"email",label:"البريد الالكتروني",rules:[{required:!0,message:"Please enter email!"}],children:(0,s.jsx)(o.A,{})}),(0,s.jsx)(p.A,{name:"password",label:"كلمة المرور",rules:[{required:!0,message:"Please enter password!"},{min:8,message:"minimum length is 8 characters"}],children:(0,s.jsx)(m.A,{})}),(0,s.jsx)(p.A,{name:"role",label:"الصلاحية",rules:[{required:!0,message:"Please select role!"}],children:(0,s.jsx)(i.A,{options:v})}),(0,s.jsx)(l.A,{justify:"end",style:{paddingRight:"4rem"},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(u.Ay,{type:"primary",htmlType:"submit",loading:h,children:"إنشاء"}),(0,s.jsx)(u.Ay,{htmlType:"reset",children:"مسح"})]})})]})}},66584:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"4092d61064b5e56b6a097920fe07164603cd949f73":()=>v,"40e39e9e7f978e8bd5c1375f0f8436b5ed0f064986":()=>x,"7f31699c58a1039e515a8e7ab5ee4dc5e73e2dc616":()=>n.i,"7fbccf63901d2a977697f12a1d602c14f4768d5b6f":()=>n.r});var s,a,n=t(4095),o=t(88852);t(11682);var i=t(78190),l=t(1227),d=t(26960),u=t(96330),c=t(71209),p=t(11475),m=t(210);let f=p.z.object({email:m.Rp,password:m.wJ,role:m.JC}),h=p.z.object({id:p.z.string().cuid()});var b=t(5886);let v=s=async e=>{try{if(!await (0,l.LX)(["ADMIN"]))return{error:"Unauthorized"};let{email:r,password:t,role:s}=f.parse(e),a=await (0,d.Er)(t),n=await i.db.user.create({data:{username:r,passwordHash:a,role:s},select:{id:!0,username:!0,role:!0}});return(0,c.revalidatePath)("/users"),n}catch(e){if(e instanceof u.Prisma.PrismaClientKnownRequestError&&"P2002"===e.code)throw Error("Unique constraint failed on the fields: `username`");if(e instanceof p.z.ZodError)return{error:e};return{error:"Unknown Error!"}}};Object.defineProperty(s,"name",{value:"default",writable:!1}),(0,b.D)([s]),(0,o.A)(s,"4092d61064b5e56b6a097920fe07164603cd949f73",null);let x=a=async e=>{if(!await (0,l.LX)(["ADMIN"]))return{error:"Unauthorized!"};let{id:r}=h.parse(e),t=await i.db.user.deleteMany({where:{id:r}});return(0,c.revalidatePath)("/users"),t.count};Object.defineProperty(a,"name",{value:"default",writable:!1}),(0,b.D)([a]),(0,o.A)(a,"40e39e9e7f978e8bd5c1375f0f8436b5ed0f064986",null)},69950:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(678).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/jad/Desktop/dev/smart/new-arc/app/components/Header.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jad/Desktop/dev/smart/new-arc/app/components/Header.tsx","default")},71890:(e,r,t)=>{Promise.resolve().then(t.bind(t,76225)),Promise.resolve().then(t.bind(t,65528)),Promise.resolve().then(t.bind(t,47924)),Promise.resolve().then(t.bind(t,24486))},76225:(e,r,t)=>{"use strict";t.d(r,{Result:()=>s.Ay});var s=t(78462)},79551:e=>{"use strict";e.exports=require("url")},93840:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[175,509,667,457,207,391,340,486,646,548,125],()=>t(1444));module.exports=s})();