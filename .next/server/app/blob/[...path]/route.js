(()=>{var e={};e.id=394,e.ids=[394],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3568:()=>{},5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},42171:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>b,routeModule:()=>m,serverHooks:()=>g,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{GET:()=>l});var o=t(99268),a=t(24825),n=t(55472),i=t(72509),u=t(76760),p=t.n(u),d=t(51455),c=t.n(d);let l=(0,t(44372).j2)(async(e,{params:r})=>{if(0>["ADMIN","EDITOR","USER"].findIndex(r=>r===e.auth?.user.role))return i.NextResponse.json({error:"Unauthorized"},{status:403});let t=(await r).path.join("/"),s=p().join(process.cwd(),"blob",t);try{let e=await c().readFile(s),r=`image/${t.split(".").pop()}`;return new i.NextResponse(e,{status:200,headers:{"Content-Type":r}})}catch(e){return console.error("Error reading image:",e),new i.NextResponse("Image not found",{status:404})}}),m=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/blob/[...path]/route",pathname:"/blob/[...path]",filename:"route",bundlePath:"app/blob/[...path]/route"},resolvedPagePath:"/Users/jad/Desktop/dev/smart/new-arc/app/blob/[...path]/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:x,serverHooks:g}=m;function b(){return(0,n.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:x})}},43817:(e,r,t)=>{"use strict";t.d(r,{db:()=>o});var s=t(96330);global.__prisma||(global.__prisma=new s.PrismaClient),global.__prisma.$connect();let o=global.__prisma},44372:(e,r,t)=>{"use strict";t.d(r,{j2:()=>w,LX:()=>h,Y9:()=>x});var s=t(35039);s.z.enum(["USER","EDITOR","ADMIN"]).default("USER");let o=s.z.string().email().transform(e=>e.toLowerCase().trim()),a=s.z.string().min(8).max(100).transform(e=>e.trim());s.z.object({email:o,password:a});let n=s.z.object({username:s.z.string(),password:s.z.string()});s.z.object({email:o}),s.z.object({password:a,passwordConfirmation:a,token:s.z.string().optional()}).refine(e=>e.password===e.passwordConfirmation,{message:"Passwords don't match",path:["passwordConfirmation"]}),s.z.object({currentPassword:s.z.string(),newPassword:a});var i=t(43817),u=t(85638),p=t(6766),d=t(5486),c=t.n(d);let l=Number.parseInt(process.env.SALT_ROUNDS||"");if(!l||!Number.isInteger(l))throw Error("SALT_ROUNDS environment variable is not set");let m=async(e,r)=>await c().compare(e,r),{auth:w,handlers:x,signIn:g,signOut:b}=(0,u.Ay)({trustHost:"true"===process.env.TRUST_HOST,useSecureCookies:"false"!==process.env.SECURE_COOKIES,callbacks:{authorized:async({auth:e})=>!!e,jwt:({token:e,user:r})=>(r&&(e.user=r),e),session:({session:e,token:r})=>({...e,user:{...e.user,...r.user}})},cookies:{sessionToken:{options:{}}},providers:[(0,p.A)({name:"credentials",async authorize(e,r){try{let{username:r,password:t}=n.parse(e),s=await i.db.user.findFirst({where:{username:r}});if(s&&await m(t,s.passwordHash))return{id:s.id,name:s.username,role:s.role}}catch(e){return null}return console.log("failed to authorize..."),null}})],pages:{signIn:"/auth/login"}}),h=async e=>{let r=await w();return e.findIndex(e=>e===r?.user.role)>=0}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},51455:e=>{"use strict";e.exports=require("node:fs/promises")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},76760:e=>{"use strict";e.exports=require("node:path")},93840:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")},99268:(e,r,t)=>{"use strict";e.exports=t(44870)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[175,509,667],()=>t(42171));module.exports=s})();